# AI Telegram Bot

[![CI](https://github.com/jewishcoder/ai-tg-bot/actions/workflows/ci.yml/badge.svg)](https://github.com/jewishcoder/ai-tg-bot/actions/workflows/ci.yml)
[![Coverage](https://img.shields.io/badge/coverage-85%25-brightgreen.svg)](./htmlcov/index.html)

LLM-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –≤ –≤–∏–¥–µ Telegram-–±–æ—Ç–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º OpenRouter API.

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –î–ª—è –Ω–æ–≤–∏—á–∫–æ–≤
- üé® **[Visual Guide](docs/guides/VISUAL_GUIDE.md)** - –í–∏–∑—É–∞–ª—å–Ω—ã–π –æ–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å –¥–∏–∞–≥—Ä–∞–º–º–∞–º–∏
- üìñ **[–í—Å–µ –≥–∞–π–¥—ã](docs/guides/README.md)** - –ü–æ–ª–Ω—ã–π –∏–Ω–¥–µ–∫—Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏ DevOps

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- üìã [vision.md](docs/vision.md) - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –≤–∏–¥–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
- ü§ù [CONTRIBUTING.md](CONTRIBUTING.md) - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∫–æ–Ω—Ç—Ä–∏–±—É—Ü–∏–∏
- üìù [CHANGELOG.md](CHANGELOG.md) - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

**–û–±—â–∏–µ:**
- Telegram Bot Token (–ø–æ–ª—É—á–∏—Ç—å —É [@BotFather](https://t.me/botfather))
- OpenRouter API Key (–ø–æ–ª—É—á–∏—Ç—å –Ω–∞ [openrouter.ai](https://openrouter.ai))

**–î–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
- [Docker Desktop](https://www.docker.com/products/docker-desktop/) –∏–ª–∏ Docker Engine
- Docker Compose v2.0+

**–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:**
- Python 3.11+
- [uv](https://github.com/astral-sh/uv) - –º–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

---

### üê≥ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:**
```bash
git clone <repository-url>
cd ai-tg-bot
cp .env.example .env.development
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env.development - —É–∫–∞–∂–∏—Ç–µ TELEGRAM_TOKEN –∏ OPENROUTER_API_KEY
```

**2. –°–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å:**
```bash
# –°–æ–±—Ä–∞—Ç—å Docker –æ–±—Ä–∞–∑
docker-compose build

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
docker-compose up -d

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
docker-compose logs -f bot
```

**3. –û—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
docker-compose down
```

üìñ –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [DOCKER.md](DOCKER.md)

---

### üíª –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)

**1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:**
```bash
git clone <repository-url>
cd ai-tg-bot
cp .env.example .env.development
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env.development - —É–∫–∞–∂–∏—Ç–µ TELEGRAM_TOKEN –∏ OPENROUTER_API_KEY
```

**2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
```bash
uv sync
```

**3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞:**

**–ß–µ—Ä–µ–∑ UV (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
```bash
uv run python -m src.main --env-file .env.development
```

**–ß–µ—Ä–µ–∑ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:**
```bash
# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source .venv/bin/activate  # Linux/Mac
# –∏–ª–∏
.venv\Scripts\activate     # Windows

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
python -m src.main --env-file .env.development
```

---

### üöÄ Production —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

–î–ª—è production –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ named volumes:

**1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π `.build/docker-compose.prod.yml` –∏ —É–∫–∞–∂–∏ —Å–≤–æ–∏ —Ç–æ–∫–µ–Ω—ã:

```yaml
environment:
  - TELEGRAM_TOKEN=your_telegram_bot_token_here
  - OPENROUTER_API_KEY=your_openrouter_api_key_here
  # –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã
```

**2. –°–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å:**

**Windows PowerShell:**
```powershell
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
.\.build\build-prod.ps1

# –ó–∞–ø—É—Å–∫
docker-compose -f .build/docker-compose.prod.yml up -d
```

**Linux/Mac:**
```bash
# –°–±–æ—Ä–∫–∞
docker-compose -f .build/docker-compose.prod.yml build

# –ó–∞–ø—É—Å–∫
docker-compose -f .build/docker-compose.prod.yml up -d
```

**3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:**
```bash
docker-compose -f .build/docker-compose.prod.yml logs -f bot
```

üìñ –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [.build/DEPLOYMENT.md](.build/DEPLOYMENT.md)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ production —Å–±–æ—Ä–∫–∏:**
- ‚úÖ –°–µ–∫—Ä–µ—Ç—ã —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –æ–±—Ä–∞–∑)
- ‚úÖ Named volumes (Docker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∞–≤–∞–º–∏)
- ‚úÖ –£–º–µ–Ω—å—à–µ–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞ (~150-200MB)
- ‚úÖ Multi-stage build –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- ‚úÖ Non-root –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π healthcheck
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ª–∏–º–∏—Ç—ã —Ä–µ—Å—É—Ä—Å–æ–≤
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Windows, Linux –∏ –≤ –æ–±–ª–∞–∫–µ –±–µ–∑ –ø—Ä–æ–±–ª–µ–º

---

## üìã –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
- `/help` - –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
- `/role <—Ç–µ–∫—Å—Ç>` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–æ–ª—å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ (—Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç)
- `/role default` - –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ä–æ–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- `/reset` - –æ—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –¥–∏–∞–ª–æ–≥–∞
- `/status` - –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

## üõ°Ô∏è –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

### Fallback –º–æ–¥–µ–ª—å

–ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω—É—é LLM –º–æ–¥–µ–ª—å** –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –æ—Å–Ω–æ–≤–Ω–æ–π. –≠—Ç–æ –ø–æ–≤—ã—à–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞—Ç –æ—Ç–≤–µ—Ç.

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

1. **–û—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞** (rate limit, —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –æ—à–∏–±–∫–∞) ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ fallback –º–æ–¥–µ–ª—å
2. **Fallback –º–æ–¥–µ–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç** ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç (–Ω–µ –≤–∏–¥–∏—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –¥–µ—Ç–∞–ª–µ–π)
3. **–û–±–µ –º–æ–¥–µ–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã** ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ fallback –º–æ–¥–µ–ª–∏:**

–î–æ–±–∞–≤—å—Ç–µ –≤ `.env.development` (–∏–ª–∏ `.env.production`):

```bash
# –û—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å (–ø–ª–∞—Ç–Ω–∞—è, –º–æ—â–Ω–∞—è)
OPENROUTER_MODEL=anthropic/claude-3.5-sonnet

# –†–µ–∑–µ—Ä–≤–Ω–∞—è –º–æ–¥–µ–ª—å (–±–µ—Å–ø–ª–∞—Ç–Ω–∞—è, –±—ã—Å—Ç—Ä–∞—è)
OPENROUTER_FALLBACK_MODEL=meta-llama/llama-3.1-8b-instruct:free
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É fallback –º–æ–¥–µ–ª–∏:**

- ‚úÖ **–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –º–æ–¥–µ–ª—å** - –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –∑–∞—Ç—Ä–∞—Ç –ø—Ä–∏ —Å–±–æ—è—Ö
- ‚úÖ **–ë—ã—Å—Ç—Ä–∞—è –º–æ–¥–µ–ª—å** - –¥–ª—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏
- ‚úÖ **–î–æ—Å—Ç—É–ø–Ω–∞—è –º–æ–¥–µ–ª—å** - –≤—ã—Å–æ–∫–∏–π rate limit
- ‚úÖ **–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å** - —Ö–æ—Ä–æ—à–∏–π fallback –ª—É—á—à–µ —á–µ–º –æ—à–∏–±–∫–∞

**–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã fallback –º–æ–¥–µ–ª–µ–π:**

| –ú–æ–¥–µ–ª—å | –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ | –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ |
|--------|--------------|------------|
| `meta-llama/llama-3.1-8b-instruct:free` | –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è, –±—ã—Å—Ç—Ä–∞—è | –ö–∞—á–µ—Å—Ç–≤–æ –Ω–∏–∂–µ –ø–ª–∞—Ç–Ω—ã—Ö |
| `google/gemini-flash-1.5` | –ë—ã—Å—Ç—Ä–∞—è, –¥–æ—Å—Ç—É–ø–Ω–∞—è | –ü–ª–∞—Ç–Ω–∞—è (–¥–µ—à–µ–≤–∞—è) |
| `openai/gpt-3.5-turbo` | –•–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ | –ü–ª–∞—Ç–Ω–∞—è |

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**

Fallback —Å–æ–±—ã—Ç–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å —É—Ä–æ–≤–Ω–µ–º `WARNING`:

```
WARNING: Primary model failed for user 12345: Rate limit exceeded. Trying fallback model: meta-llama/llama-3.1-8b-instruct:free
INFO: Fallback model succeeded for user 12345. Model: meta-llama/llama-3.1-8b-instruct:free. Tokens: 45
```

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: [docs/FALLBACK.md](docs/FALLBACK.md)

## üõ†Ô∏è Development

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ [üíª –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫](#-–ª–æ–∫–∞–ª—å–Ω—ã–π-–∑–∞–ø—É—Å–∫-–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞), –∑–∞—Ç–µ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å dev-–ø–∞–∫–µ—Ç–∞–º–∏
uv sync --all-extras

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å pre-commit hooks
make pre-commit-install
```

Pre-commit hooks –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ª–∏–Ω—Ç–∏–Ω–≥ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∫–æ–º–º–∏—Ç–æ–º.

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞

**–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
make format
```

**–õ–∏–Ω—Ç–∏–Ω–≥ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤:**
```bash
make lint
```

**–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:**
```bash
make test        # –° coverage –æ—Ç—á—ë—Ç–æ–º
make test-fast   # –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ –±–µ–∑ coverage
```

**–í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ä–∞–∑—É (–∫–∞–∫ –≤ CI):**
```bash
make ci
```

### –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∫–æ–¥–∞

- ‚úÖ **–û–¥–∏–Ω –∫–ª–∞—Å—Å = –æ–¥–∏–Ω —Ñ–∞–π–ª** (Single Responsibility Principle)
- ‚úÖ **Type hints** –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –¥–ª—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ –º–µ—Ç–æ–¥–æ–≤
- ‚úÖ **Docstrings** –¥–ª—è –≤—Å–µ—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
- ‚úÖ **Async/await** –¥–ª—è –≤—Å–µ—Ö I/O –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –∫–ª—é—á–µ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π (–Ω–µ `print()`)
- ‚úÖ **–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏** –Ω–µ –º–µ–Ω–µ–µ 70% –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –ª–æ–≥–∏–∫–∏

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: [docs/vision.md](docs/vision.md) –∏ [CONTRIBUTING.md](CONTRIBUTING.md)

### CI/CD

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **GitHub Actions** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞:
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Ruff)
- ‚úÖ –õ–∏–Ω—Ç–∏–Ω–≥ (Ruff)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ (Mypy)
- ‚úÖ –¢–µ—Å—Ç—ã —Å coverage (Pytest)

**Coverage —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –ø—Ä–æ–µ–∫—Ç–∞: –º–∏–Ω–∏–º—É–º 30%
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ª–æ–≥–∏–∫–∞ (Storage, LLMClient): –º–∏–Ω–∏–º—É–º 70% ‚úÖ

CI –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ push/PR –≤ –≤–µ—Ç–∫–∏ `main` –∏ `develop`.

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
ai-tg-bot/
‚îú‚îÄ‚îÄ src/              # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îú‚îÄ‚îÄ data/             # JSON —Ñ–∞–π–ª—ã —Å –∏—Å—Ç–æ—Ä–∏–µ–π –¥–∏–∞–ª–æ–≥–æ–≤
‚îú‚îÄ‚îÄ logs/             # –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ tests/            # –¢–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ docs/             # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ .env              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–Ω–µ –≤ git)
‚îú‚îÄ‚îÄ .env.example      # –®–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ pyproject.toml    # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
```

## üìÇ –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã

### –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
- [`src/main.py`](src/main.py) - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- [`src/bot.py`](src/bot.py) - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å Telegram-–±–æ—Ç–∞
- [`src/llm_client.py`](src/llm_client.py) - –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å LLM —á–µ—Ä–µ–∑ OpenRouter
- [`src/storage.py`](src/storage.py) - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–µ–π –¥–∏–∞–ª–æ–≥–æ–≤
- [`src/config.py`](src/config.py) - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- [`.env.example`](.env.example) - —à–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- [`pyproject.toml`](pyproject.toml) - –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
- [`uv.lock`](uv.lock) - –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### Docker
- [`Dockerfile.dev`](Dockerfile.dev) - Docker –æ–±—Ä–∞–∑ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- [`docker-compose.yml`](docker-compose.yml) - –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (development)
- [`.build/`](.build/) - production —Å–±–æ—Ä–∫–∞ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
- [`Makefile`](Makefile) - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥
- [`DOCKER.md`](DOCKER.md) - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é Docker

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- [`docs/`](docs/) - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (vision, tasklist, idea)
- [`CONTRIBUTING.md`](CONTRIBUTING.md) - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∫–æ–Ω—Ç—Ä–∏–±—É—Ü–∏–∏
- [`.cursor/rules/`](.cursor/rules/) - –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è Cursor IDE

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.11+** - –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫
- **aiogram 3.x** - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Telegram Bot API
- **OpenAI SDK** - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å OpenRouter API
- **Pydantic** - –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- **uv** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- **Docker** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## üê≥ Deployment

### Docker Registry

–ü—Ä–æ–µ–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—É–±–ª–∏–∫—É–µ—Ç Docker –æ–±—Ä–∞–∑—ã –≤ Yandex Cloud Container Registry –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ `main`.

**–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –í–µ—Ä—Å–∏—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `VERSION` –≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (—Ñ–æ—Ä–º–∞—Ç: `1.0.0`)
- –ü—Ä–∏ push –≤ `main` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –æ–±—Ä–∞–∑—ã —Å —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–µ–π

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –æ–±—Ä–∞–∑—ã:**

```bash
# –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è
cr.yandex/{registry-id}/ai-tg-bot:0.1.0

# –ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è
cr.yandex/{registry-id}/ai-tg-bot:latest
```

**–ö–∞–∫ –æ–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é:**

1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `VERSION`: `0.1.0` ‚Üí `0.2.0`
2. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ: `git commit -am "chore: bump version to 0.2.0"`
3. Push –≤ `main`: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–µ—Ä—É—Ç—Å—è –æ–±—Ä–∞–∑—ã `0.2.0` –∏ `latest`

**Pull –æ–±—Ä–∞–∑–∞:**

```bash
# –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ Yandex Container Registry
yc container registry configure-docker

# Pull –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏
docker pull cr.yandex/{registry-id}/ai-tg-bot:0.1.0

# Pull –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏
docker pull cr.yandex/{registry-id}/ai-tg-bot:latest
```

**–ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:**

```bash
docker run -d \
  --name ai-tg-bot \
  --env-file .env.production \
  -v $(pwd)/data:/app/data \
  -v $(pwd)/logs:/app/logs \
  --restart unless-stopped \
  cr.yandex/{registry-id}/ai-tg-bot:latest
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:**

```bash
# –õ–æ–≥–∏
docker logs ai-tg-bot -f

# –°—Ç–∞—Ç—É—Å
docker ps | grep ai-tg-bot

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker stop ai-tg-bot

# –£–¥–∞–ª–µ–Ω–∏–µ
docker rm ai-tg-bot
```

### –¢—Ä–µ–±—É–µ–º—ã–µ GitHub Secrets

–î–ª—è —Ä–∞–±–æ—Ç—ã CI/CD –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ **Settings ‚Üí Secrets and variables ‚Üí Actions**:

| –°–µ–∫—Ä–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏—è |
|--------|----------|-----------------|
| `YA_CLOUD_REGISTRY` | JSON –∫–ª—é—á Service Account | `{"id": "aje...", "service_account_id": "...", ...}` |
| `YC_REGISTRY_ID` | ID Container Registry | `crp1234567890abcdef` |

–ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Yandex Cloud —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ [docs/techDebtTasklist.md](docs/techDebtTasklist.md) (–ò—Ç–µ—Ä–∞—Ü–∏—è 6).

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

–ú—ã —Ä–∞–¥—ã –ª—é–±–æ–º—É –≤–∫–ª–∞–¥—É! –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å [CONTRIBUTING.md](CONTRIBUTING.md) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ:
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∞—Ö –∫–æ–¥–∞
- –ü—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö –∫ —Ç–µ—Å—Ç–∞–º
- –°–æ–∑–¥–∞–Ω–∏–∏ Pull Request

–°–ª–µ–¥—É–π—Ç–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º KISS –∏ –û–û–ü, –æ–ø–∏—Å–∞–Ω–Ω—ã–º –≤ [docs/vision.md](docs/vision.md).

