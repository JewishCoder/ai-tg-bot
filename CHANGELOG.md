# Changelog

–í—Å–µ –∑–Ω–∞—á–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ–µ–∫—Ç–µ –±—É–¥—É—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ.

–§–æ—Ä–º–∞—Ç –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
–∏ –ø—Ä–æ–µ–∫—Ç —Å–ª–µ–¥—É–µ—Ç [Semantic Versioning](https://semver.org/lang/ru/).

## [Unreleased]

### Added
- üõ°Ô∏è **Fallback –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏**
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω—É—é LLM –º–æ–¥–µ–ª—å –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –æ—Å–Ω–æ–≤–Ω–æ–π
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `OPENROUTER_FALLBACK_MODEL` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
  - –£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–≥–¥–∞ –Ω—É–∂–µ–Ω fallback (Rate Limit, API Errors)
  - Retry –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è fallback –º–æ–¥–µ–ª–∏ (3 –ø–æ–ø—ã—Ç–∫–∏)
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö fallback –æ–ø–µ—Ä–∞—Ü–∏–π —Å —É—Ä–æ–≤–Ω–µ–º WARNING
  - –ü–æ–ª–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–µ –≤–∏–¥—è—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –¥–µ—Ç–∞–ª–µ–π)
- üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è fallback –º–µ—Ö–∞–Ω–∏–∑–º–∞ (`docs/FALLBACK.md`)
- üß™ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è fallback —Ñ–ª–æ—É (5 –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤)
- üìä Coverage —É–≤–µ–ª–∏—á–µ–Ω –¥–æ 85% (—Å 80%)

### Changed
- ‚ö° `LLMClient` —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç fallback –º–æ–¥–µ–ª—å
- üìù –û–±–Ω–æ–≤–ª–µ–Ω `README.md` —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º fallback —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
- üéØ –û–±–Ω–æ–≤–ª–µ–Ω—ã `docs/idea.md` –∏ `docs/vision.md` —Å fallback —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–µ–π

### Technical Details
- –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –≤ `LLMClient`:
  - `_should_try_fallback(error)` - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω—É–∂–µ–Ω –ª–∏ fallback
  - `_try_fallback_model(messages, user_id, error)` - –≤—ã–ø–æ–ª–Ω—è–µ—Ç fallback –∑–∞–ø—Ä–æ—Å
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è fallback –≤ `generate_response()` –¥–ª—è RateLimitError –∏ APIError
- Fallback –ù–ï —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–ª—è Timeout –∏ Connection –æ—à–∏–±–æ–∫ (–ø—Ä–æ–±–ª–µ–º–∞ —Å–µ—Ç–∏)
- –ü–æ–ª–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å - fallback –æ–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω

### Tests
- ‚úÖ 4 –Ω–æ–≤—ã—Ö unit-—Ç–µ—Å—Ç–∞ –¥–ª—è Config (fallback model)
- ‚úÖ 7 –Ω–æ–≤—ã—Ö unit-—Ç–µ—Å—Ç–æ–≤ –¥–ª—è LLMClient (fallback –ª–æ–≥–∏–∫–∞)
- ‚úÖ 5 –Ω–æ–≤—ã—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ (end-to-end fallback —Ñ–ª–æ—É)
- ‚úÖ –í—Å–µ–≥–æ 65 —Ç–µ—Å—Ç–æ–≤ (coverage 85%)

## [0.1.0] - 2025-10-11

### Added
- ü§ñ –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å Telegram –±–æ—Ç–∞
- üß† –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenRouter API –¥–ª—è LLM
- üíæ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–µ–π –¥–∏–∞–ª–æ–≥–æ–≤ (Storage)
- üé≠ –°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç
- üîÑ Retry –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–±–æ–µ–≤
- üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- üê≥ Docker support —Å development –∏ production —Å–±–æ—Ä–∫–∞–º–∏
- üß™ Unit –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (coverage 80%)
- üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (README, CONTRIBUTING, docs/)
- üîß CI/CD —á–µ—Ä–µ–∑ GitHub Actions
- üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤ Yandex Container Registry

### Commands
- `/start` - –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
- `/help` - —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
- `/role <—Ç–µ–∫—Å—Ç>` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–æ–ª—å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
- `/role default` - –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ä–æ–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- `/reset` - –æ—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –¥–∏–∞–ª–æ–≥–∞
- `/status` - –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

### Tech Stack
- Python 3.11+
- aiogram 3.x - Telegram Bot API
- OpenAI SDK - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å OpenRouter
- Pydantic - –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- uv - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- Docker - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- Pytest - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## –¢–∏–ø—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π

- `Added` - –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- `Changed` - –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ
- `Deprecated` - —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–∫–æ—Ä–æ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã
- `Removed` - —É–¥–∞–ª–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- `Fixed` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–æ–≤
- `Security` - –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

[Unreleased]: https://github.com/jewishcoder/ai-tg-bot/compare/v0.1.0...HEAD
[0.1.0]: https://github.com/jewishcoder/ai-tg-bot/releases/tag/v0.1.0

